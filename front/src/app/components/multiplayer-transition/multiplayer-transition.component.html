<div
  class="multiplayer-transition"
  *ngIf="show">

  <div class="transition-header">
    <div class="header-content">
      <tui-icon icon="@tui.trophy" class="trophy-icon"></tui-icon>
      <h1 class="transition-title">Classement</h1>
      <div class="question-info">
        <span class="question-number">Question {{ questionNumber }}/{{ totalQuestions }}</span>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="getProgressPercentage()"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="players-container">
    <div
      *ngFor="let player of players; let i = index"
      class="player-card"
      [ngClass]="getPlayerCardClass(player)">

      <div class="player-rank" [style.color]="getRankColor(player.rank)">
        <span class="rank-medal" *ngIf="player.rank <= 3">{{ getRankMedal(player.rank) }}</span>
        <span class="rank-number" *ngIf="player.rank > 3">#{{ player.rank }}</span>
      </div>

      <div class="player-avatar">
        <div class="avatar-blob"
             [class.current-user]="player.isCurrentUser"
             [ngStyle]="getAvatarStyle(player)">
          <div class="avatar-shape" *ngIf="player.avatar?.shape">
            <img [src]="'/assets/avatars/' + getAvatarShape(player) + '.svg'"
                 [alt]="player.username + ' shape'"
                 class="shape-svg">
          </div>
          <span class="avatar-initial">{{ player.username.charAt(0).toUpperCase() }}</span>
        </div>
        <div class="user-crown" *ngIf="player.rank === 1">ðŸ‘‘</div>
      </div>

      <div class="player-info">
        <div class="player-name">
          {{ player.username }}
          <span class="you-badge" *ngIf="player.isCurrentUser">C'est vous !</span>
        </div>

        <div class="player-scores">
          <div class="main-score">{{ player.scorePercentage }}/100</div>
          <div class="raw-score">{{ player.score }} points</div>
        </div>

        <div class="points-gained" *ngIf="player.pointsGained !== undefined">
          <span class="points-text"
                [class.positive]="player.pointsGained > 0"
                [class.zero]="player.pointsGained === 0">
            {{ player.pointsGained > 0 ? '+' : '' }}{{ player.pointsGained }} pts
          </span>
        </div>
      </div>

      <div class="answer-result" *ngIf="player.lastAnswerCorrect !== undefined">
        <div class="answer-icon"
             [class.correct]="player.lastAnswerCorrect"
             [class.incorrect]="!player.lastAnswerCorrect">
          <tui-icon [icon]="player.lastAnswerCorrect ? '@tui.check' : '@tui.x'"></tui-icon>
        </div>
      </div>
    </div>
  </div>

  <div class="transition-footer">
    <div class="footer-content">
      <div class="next-question-info">
        <span *ngIf="questionNumber < totalQuestions">Prochaine question dans quelques instants...</span>
        <span *ngIf="questionNumber >= totalQuestions">ðŸŽ‰ Quiz terminÃ© ! RÃ©sultats finaux ðŸŽ‰</span>
      </div>
    </div>
  </div>
</div>
