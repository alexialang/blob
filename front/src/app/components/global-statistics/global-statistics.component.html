<div class="stats-container">
  <div class="stats-header">
    <h3>Statistiques Globales</h3>
    <div class="header-controls">
      <div class="filter-controls">
        <label for="quizFilter">Filtrer par nom :</label>
        <input
          type="text"
          id="quizFilter"
          [(ngModel)]="quizFilter"
          (input)="onQuizFilterChange()"
          placeholder="Rechercher un quiz..."
          class="quiz-filter-input"
        />
      </div>
      <button class="btn-refresh" (click)="refreshStats()" [disabled]="loading">
        ğŸ”„ {{ loading ? 'Actualisation...' : 'Actualiser' }}
      </button>
    </div>
  </div>

  <div *ngIf="loading" class="loading">Chargement...</div>

  <div *ngIf="!loading && !stats && error" class="error-message">
    <p> Erreur lors du chargement des statistiques</p>
    <p *ngIf="error.status === 401">Veuillez vous reconnecter</p>
    <p *ngIf="error.status === 403">Vous n'avez pas les permissions nÃ©cessaires</p>
    <p *ngIf="error.status === 500">Erreur serveur - Veuillez rÃ©essayer plus tard</p>
    <button (click)="refreshStats()" class="btn-retry">RÃ©essayer</button>
  </div>

  <div class="chart-container" [style.display]="(!loading && stats && !error) ? 'block' : 'none'">
    <canvas #statsChart id="statsChart"></canvas>
  </div>

  <div *ngIf="!loading && stats" class="stats-summary">
    <div class="summary-item">
      <strong>Quiz d'Ã©quipe :</strong> {{ getFilteredTeamScores().length }} quiz
    </div>
    <div class="summary-item">
      <strong>Quiz de groupes :</strong> {{ getTotalGroupQuizzes() }} quiz
    </div>
  </div>
</div>
