/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@taiga-ui/core@4.36.0/fesm2022/taiga-ui-core-components-scrollbar.mjs
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{AsyncPipe as t,NgIf as e}from"@angular/common";import*as i from"@angular/core";import{inject as n,Injectable as o,Directive as r,Input as s,Component as l,ChangeDetectionStrategy as a,ElementRef as c,DestroyRef as h}from"@angular/core";import{WA_ANIMATION_FRAME as p}from"@ng-web-apis/common";import{tuiTypedFromEvent as m,tuiZonefree as d,tuiZonefreeScheduler as u,tuiScrollFrom as b,tuiZoneOptimized as g}from"@taiga-ui/cdk/observables";import{tuiFadeIn as v}from"@taiga-ui/core/animations";import{TUI_SCROLL_REF as f,TUI_ANIMATIONS_SPEED as y}from"@taiga-ui/core/tokens";import{tuiToAnimationOptions as I}from"@taiga-ui/core/utils";import{Observable as S,merge as z,filter as w,map as k,switchMap as x,takeUntil as _,throttleTime as D,startWith as V,distinctUntilChanged as R,timer as C}from"rxjs";import{takeUntilDestroyed as F}from"@angular/core/rxjs-interop";import{tuiInjectElement as H,tuiGetElementOffset as W}from"@taiga-ui/cdk/utils/dom";import{tuiCreateOptions as T}from"@taiga-ui/cdk/utils/di";import{TUI_IS_IOS as E}from"@taiga-ui/cdk/tokens";import{tuiProvide as M}from"@taiga-ui/cdk/utils/miscellaneous";class $ extends S{constructor(){super((t=>this.scroll$.subscribe(t))),this.el=H(),this.element=n(f).nativeElement,this.scroll$=z(m(this.el.parentElement,"mousedown").pipe(w((({target:t})=>t!==this.el)),k((t=>this.getScrolled(t,.5,.5)))),m(this.el,"mousedown").pipe(d(),x((t=>{const{ownerDocument:e}=this.el,i=this.el.getBoundingClientRect(),n=function({clientY:t},{top:e,height:i}){return(t-e)/i}(t,i),o=function({clientX:t},{left:e,width:i}){return(t-e)/i}(t,i);return m(e,"mousemove").pipe(k((t=>this.getScrolled(t,n,o))),_(m(e,"mouseup")))}))))}getScrolled({clientY:t,clientX:e},i,n){const{offsetHeight:o,offsetWidth:r}=this.el,{top:s,left:l,width:a,height:c}=this.el.parentElement.getBoundingClientRect();return[(this.element.scrollHeight-c)*((t-s-o*i)/(c-o)),(this.element.scrollWidth-a)*((e-l-r*n)/(a-r))]}static{this.ɵfac=i.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:$,deps:[],target:i.ɵɵFactoryTarget.Injectable})}static{this.ɵprov=i.ɵɵngDeclareInjectable({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:$})}}i.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:$,decorators:[{type:o}],ctorParameters:function(){return[]}});class O{constructor(){this.el=n(f).nativeElement,this.style=H().style,this.scrollSub=n($).pipe(F()).subscribe((([t,e])=>{this.el.style.scrollBehavior="auto","horizontal"===this.tuiScrollbar?this.el.scrollLeft=e:this.el.scrollTop=t,this.el.style.scrollBehavior=""})),this.styleSub=z(n(p).pipe(D(100,u())),b(this.el)).pipe(d(),F()).subscribe((()=>{const t={scrollTop:this.el.scrollTop,scrollHeight:this.el.scrollHeight,clientHeight:this.el.clientHeight,scrollLeft:this.el.scrollLeft,scrollWidth:this.el.scrollWidth,clientWidth:this.el.clientWidth},e=100*this.getThumb(t)+"%",i=100*this.getView(t)+"%";"vertical"===this.tuiScrollbar?(this.style.top=e,this.style.height=i):(this.style.left=e,this.style.width=i)})),this.tuiScrollbar="vertical"}getScrolled(t){return"vertical"===this.tuiScrollbar?t.scrollTop/(t.scrollHeight-t.clientHeight):t.scrollLeft/(t.scrollWidth-t.clientWidth)}getCompensation(t){return t.clientHeight*t.clientHeight/t.scrollHeight>24&&"vertical"===this.tuiScrollbar||t.clientWidth*t.clientWidth/t.scrollWidth>24&&"horizontal"===this.tuiScrollbar?0:"vertical"===this.tuiScrollbar?24/t.clientHeight:24/t.clientWidth}getThumb(t){const e=this.getCompensation(t)||this.getView(t);return this.getScrolled(t)*(1-e)}getView(t){return"vertical"===this.tuiScrollbar?Math.ceil(t.clientHeight/t.scrollHeight*100)/100:Math.ceil(t.clientWidth/t.scrollWidth*100)/100}static{this.ɵfac=i.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:O,deps:[],target:i.ɵɵFactoryTarget.Directive})}static{this.ɵdir=i.ɵɵngDeclareDirective({minVersion:"14.0.0",version:"16.2.12",type:O,isStandalone:!0,selector:"[tuiScrollbar]",inputs:{tuiScrollbar:"tuiScrollbar"},providers:[$],ngImport:i})}}i.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:O,decorators:[{type:r,args:[{standalone:!0,selector:"[tuiScrollbar]",providers:[$]}]}],propDecorators:{tuiScrollbar:[{type:s}]}});const L={mode:"always"},[P,j]=T(L);class B{constructor(){this.scrollRef=n(f).nativeElement,this.nativeScrollbar="native"===n(P).mode,this.options=I(n(y)),this.refresh$=n(p).pipe(D(300,u()),k((()=>this.scrollbars)),V([!1,!1]),R(((t,e)=>t[0]===e[0]&&t[1]===e[1])),g())}get scrollbars(){const{clientHeight:t,scrollHeight:e,clientWidth:i,scrollWidth:n}=this.scrollRef;return[Math.ceil(t/e*100)<100,Math.ceil(i/n*100)<100]}static{this.ɵfac=i.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:B,deps:[],target:i.ɵɵFactoryTarget.Component})}static{this.ɵcmp=i.ɵɵngDeclareComponent({minVersion:"14.0.0",version:"16.2.12",type:B,isStandalone:!0,selector:"tui-scroll-controls",ngImport:i,template:'<ng-container *ngIf="nativeScrollbar; else custom" />\n<ng-template #custom>\n    <ng-container *ngIf="refresh$ | async as bars">\n        <div\n            *ngIf="bars[0]"\n            class="t-bar t-bar_vertical"\n            [@tuiFadeIn]="options"\n            [class.t-bar_has-horizontal]="bars[1]"\n            (mousedown.capture.prevent)="(0)"\n        >\n            <div\n                tuiScrollbar="vertical"\n                class="t-thumb"\n            ></div>\n        </div>\n        <div\n            *ngIf="bars[1]"\n            class="t-bar t-bar_horizontal"\n            [@tuiFadeIn]="options"\n            [class.t-bar_has-vertical]="bars[0]"\n            (mousedown.capture.prevent)="(0)"\n        >\n            <div\n                tuiScrollbar="horizontal"\n                class="t-thumb"\n            ></div>\n        </div>\n    </ng-container>\n</ng-template>\n',styles:[":host{position:sticky;top:0;left:0;z-index:1;min-inline-size:calc(100% - 1px);min-block-size:calc(100% - 1px);max-inline-size:calc(100% - 1px);max-block-size:calc(100% - 1px);float:inline-start;margin-inline-end:calc(-100% + 1px);pointer-events:none}.t-bar{position:absolute;right:0;bottom:0;pointer-events:auto}.t-bar_vertical{top:0;inline-size:.875rem}.t-bar_horizontal{left:0;block-size:.875rem}.t-bar_has-horizontal{bottom:.5rem}.t-bar_has-vertical{right:.5rem}.t-thumb{transition-property:all;transition-duration:.15s;transition-timing-function:ease-in-out;position:absolute;border-radius:6.25rem;border:.25rem solid transparent;cursor:pointer;pointer-events:auto;-webkit-user-select:none;user-select:none;background:currentColor;background-clip:content-box;box-sizing:border-box;transition-property:width,height,opacity;opacity:.2}.t-thumb:hover{opacity:.24}.t-thumb:active{opacity:.48}.t-bar_vertical .t-thumb{right:0;inline-size:.75rem;min-block-size:1.25rem}.t-bar_vertical:hover .t-thumb,.t-bar_vertical .t-thumb:active{inline-size:.875rem}.t-bar_horizontal .t-thumb{bottom:0;block-size:.75rem;min-inline-size:1.25rem}.t-bar_horizontal:hover .t-thumb,.t-bar_horizontal .t-thumb:active{block-size:.875rem}\n"],dependencies:[{kind:"pipe",type:t,name:"async"},{kind:"directive",type:e,selector:"[ngIf]",inputs:["ngIf","ngIfThen","ngIfElse"]},{kind:"directive",type:O,selector:"[tuiScrollbar]",inputs:["tuiScrollbar"]}],animations:[v],changeDetection:i.ChangeDetectionStrategy.OnPush})}}i.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:B,decorators:[{type:l,args:[{standalone:!0,selector:"tui-scroll-controls",imports:[t,e,O],changeDetection:a.OnPush,animations:[v],template:'<ng-container *ngIf="nativeScrollbar; else custom" />\n<ng-template #custom>\n    <ng-container *ngIf="refresh$ | async as bars">\n        <div\n            *ngIf="bars[0]"\n            class="t-bar t-bar_vertical"\n            [@tuiFadeIn]="options"\n            [class.t-bar_has-horizontal]="bars[1]"\n            (mousedown.capture.prevent)="(0)"\n        >\n            <div\n                tuiScrollbar="vertical"\n                class="t-thumb"\n            ></div>\n        </div>\n        <div\n            *ngIf="bars[1]"\n            class="t-bar t-bar_horizontal"\n            [@tuiFadeIn]="options"\n            [class.t-bar_has-vertical]="bars[0]"\n            (mousedown.capture.prevent)="(0)"\n        >\n            <div\n                tuiScrollbar="horizontal"\n                class="t-thumb"\n            ></div>\n        </div>\n    </ng-container>\n</ng-template>\n',styles:[":host{position:sticky;top:0;left:0;z-index:1;min-inline-size:calc(100% - 1px);min-block-size:calc(100% - 1px);max-inline-size:calc(100% - 1px);max-block-size:calc(100% - 1px);float:inline-start;margin-inline-end:calc(-100% + 1px);pointer-events:none}.t-bar{position:absolute;right:0;bottom:0;pointer-events:auto}.t-bar_vertical{top:0;inline-size:.875rem}.t-bar_horizontal{left:0;block-size:.875rem}.t-bar_has-horizontal{bottom:.5rem}.t-bar_has-vertical{right:.5rem}.t-thumb{transition-property:all;transition-duration:.15s;transition-timing-function:ease-in-out;position:absolute;border-radius:6.25rem;border:.25rem solid transparent;cursor:pointer;pointer-events:auto;-webkit-user-select:none;user-select:none;background:currentColor;background-clip:content-box;box-sizing:border-box;transition-property:width,height,opacity;opacity:.2}.t-thumb:hover{opacity:.24}.t-thumb:active{opacity:.48}.t-bar_vertical .t-thumb{right:0;inline-size:.75rem;min-block-size:1.25rem}.t-bar_vertical:hover .t-thumb,.t-bar_vertical .t-thumb:active{inline-size:.875rem}.t-bar_horizontal .t-thumb{bottom:0;block-size:.75rem;min-inline-size:1.25rem}.t-bar_horizontal:hover .t-thumb,.t-bar_horizontal .t-thumb:active{block-size:.875rem}\n"]}]}]});const X="tui-scroll-into-view",Y="tui-scrollable";class q{constructor(){this.el=H(),this.options=n(P),this.isIOS=n(E),this.browserScrollRef=new c(this.el),this.hidden="hidden"===this.options.mode}get delegated(){return this.scrollRef!==this.el||"native"===this.options.mode}get scrollRef(){return this.browserScrollRef.nativeElement}set scrollRef(t){this.browserScrollRef.nativeElement=t}scrollIntoView(t){if(this.delegated)return;const{offsetHeight:e,offsetWidth:i}=t,{offsetTop:n,offsetLeft:o}=W(this.scrollRef,t),r=n+e/2-this.scrollRef.clientHeight/2,s=o+i/2-this.scrollRef.clientWidth/2;this.scrollRef.scrollTo?.(s,r)}static{this.ɵfac=i.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:q,deps:[],target:i.ɵɵFactoryTarget.Component})}static{this.ɵcmp=i.ɵɵngDeclareComponent({minVersion:"14.0.0",version:"16.2.12",type:q,isStandalone:!0,selector:"tui-scrollbar",inputs:{hidden:"hidden"},host:{listeners:{"tui-scrollable.stop":"scrollRef = $event.detail","tui-scroll-into-view.stop":"scrollIntoView($event.detail)"},properties:{"class._native-hidden":'options.mode !== "native" && (!isIOS || hidden)'}},providers:[{provide:f,useFactory:()=>n(q).browserScrollRef}],ngImport:i,template:'<tui-scroll-controls\n    *ngIf="!hidden && !isIOS && options.mode !== \'native\'"\n    class="t-bars"\n    [class.t-hover-mode]="options.mode === \'hover\'"\n/>\n<div\n    class="t-content"\n    [class.t-content_delegated]="delegated"\n>\n    <ng-content />\n</div>\n',styles:[":host{position:relative;display:flex;max-block-size:100%;isolation:isolate;overflow:auto}:host._native-hidden{scrollbar-width:none;-ms-overflow-style:none}:host._native-hidden::-webkit-scrollbar,:host._native-hidden::-webkit-scrollbar-thumb{display:none}:host .t-hover-mode:not(:active){transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;opacity:0}:host:hover .t-hover-mode{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;opacity:1}.t-content{isolation:isolate;flex:1;flex-basis:auto;inline-size:100%;block-size:-webkit-max-content;block-size:max-content}.t-content_delegated{block-size:100%}.t-bars{color:var(--tui-text-primary)}\n"],dependencies:[{kind:"directive",type:e,selector:"[ngIf]",inputs:["ngIf","ngIfThen","ngIfElse"]},{kind:"component",type:B,selector:"tui-scroll-controls"}],changeDetection:i.ChangeDetectionStrategy.OnPush})}}i.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:q,decorators:[{type:l,args:[{standalone:!0,selector:"tui-scrollbar",imports:[e,B],changeDetection:a.OnPush,providers:[{provide:f,useFactory:()=>n(q).browserScrollRef}],host:{"[class._native-hidden]":'options.mode !== "native" && (!isIOS || hidden)',[`(${Y}.stop)`]:"scrollRef = $event.detail",[`(${X}.stop)`]:"scrollIntoView($event.detail)"},template:'<tui-scroll-controls\n    *ngIf="!hidden && !isIOS && options.mode !== \'native\'"\n    class="t-bars"\n    [class.t-hover-mode]="options.mode === \'hover\'"\n/>\n<div\n    class="t-content"\n    [class.t-content_delegated]="delegated"\n>\n    <ng-content />\n</div>\n',styles:[":host{position:relative;display:flex;max-block-size:100%;isolation:isolate;overflow:auto}:host._native-hidden{scrollbar-width:none;-ms-overflow-style:none}:host._native-hidden::-webkit-scrollbar,:host._native-hidden::-webkit-scrollbar-thumb{display:none}:host .t-hover-mode:not(:active){transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;opacity:0}:host:hover .t-hover-mode{transition-property:opacity;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;opacity:1}.t-content{isolation:isolate;flex:1;flex-basis:auto;inline-size:100%;block-size:-webkit-max-content;block-size:max-content}.t-content_delegated{block-size:100%}.t-bars{color:var(--tui-text-primary)}\n"]}]}],propDecorators:{hidden:[{type:s}]}});class A{constructor(){this.el=H(),this.destroyRef=n(h)}set tuiScrollIntoView(t){t&&C(0).pipe(F(this.destroyRef)).subscribe((()=>{this.el.dispatchEvent(new CustomEvent(X,{bubbles:!0,detail:this.el}))}))}static{this.ɵfac=i.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:A,deps:[],target:i.ɵɵFactoryTarget.Directive})}static{this.ɵdir=i.ɵɵngDeclareDirective({minVersion:"14.0.0",version:"16.2.12",type:A,isStandalone:!0,selector:"[tuiScrollIntoView]",inputs:{tuiScrollIntoView:"tuiScrollIntoView"},ngImport:i})}}i.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:A,decorators:[{type:r,args:[{standalone:!0,selector:"[tuiScrollIntoView]"}]}],propDecorators:{tuiScrollIntoView:[{type:s}]}});const G="[tuiScrollRef]";class J{static{this.ɵfac=i.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:J,deps:[],target:i.ɵɵFactoryTarget.Directive})}static{this.ɵdir=i.ɵɵngDeclareDirective({minVersion:"14.0.0",version:"16.2.12",type:J,isStandalone:!0,selector:"[tuiScrollRef]",providers:[M(f,c)],ngImport:i})}}i.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:J,decorators:[{type:r,args:[{standalone:!0,selector:G,providers:[M(f,c)]}]}]});class K{constructor(){this.el=H()}ngOnInit(){this.el.dispatchEvent(new CustomEvent(Y,{bubbles:!0,detail:this.el}))}static{this.ɵfac=i.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:K,deps:[],target:i.ɵɵFactoryTarget.Directive})}static{this.ɵdir=i.ɵɵngDeclareDirective({minVersion:"14.0.0",version:"16.2.12",type:K,isStandalone:!0,selector:"[tuiScrollable]",ngImport:i})}}i.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:i,type:K,decorators:[{type:r,args:[{standalone:!0,selector:"[tuiScrollable]"}]}]});export{G as SCROLL_REF_SELECTOR,L as TUI_DEFAULT_SCROLLBAR_OPTIONS,Y as TUI_SCROLLABLE,P as TUI_SCROLLBAR_OPTIONS,X as TUI_SCROLL_INTO_VIEW,B as TuiScrollControls,A as TuiScrollIntoView,J as TuiScrollRef,K as TuiScrollable,q as TuiScrollbar,O as TuiScrollbarDirective,$ as TuiScrollbarService,j as tuiScrollbarOptionsProvider};export default null;
