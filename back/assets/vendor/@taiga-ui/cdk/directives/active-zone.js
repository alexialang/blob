/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@taiga-ui/cdk@4.36.0/fesm2022/taiga-ui-cdk-directives-active-zone.mjs
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{__decorate as e}from"tslib";import*as t from"@angular/core";import{inject as n,NgZone as i,Directive as o,Output as s,Input as r}from"@angular/core";import{NgControl as c}from"@angular/forms";import{tuiZoneOptimized as a}from"@taiga-ui/cdk/observables";import{TUI_ACTIVE_ELEMENT as u}from"@taiga-ui/cdk/tokens";import{tuiInjectElement as v,tuiArrayRemove as m,tuiPure as h}from"@taiga-ui/cdk/utils";import{map as A,startWith as Z,distinctUntilChanged as p,skip as l,tap as g,share as d}from"rxjs";class f{constructor(){this.control=n(c,{self:!0,optional:!0}),this.active$=n(u),this.zone=n(i),this.el=v(),this.tuiActiveZoneParent=null,this.subActiveZones=[],this.directParentActiveZone=n(f,{skipSelf:!0,optional:!0}),this.tuiActiveZoneChange=this.active$.pipe(A((e=>!!e&&this.contains(e))),Z(!1),p(),l(1),g((e=>{e||"function"!=typeof this.control?.valueAccessor.onTouched||this.control.valueAccessor.onTouched()})),a(this.zone),d()),this.directParentActiveZone?.addSubActiveZone(this)}set tuiActiveZoneParentSetter(e){this.setZone(e)}ngOnDestroy(){this.directParentActiveZone?.removeSubActiveZone(this),this.tuiActiveZoneParent?.removeSubActiveZone(this)}contains(e){return this.el.contains(e)||this.subActiveZones.some(((t,n,i)=>i.indexOf(t)===n&&t.contains(e)))}setZone(e){this.tuiActiveZoneParent?.removeSubActiveZone(this),e?.addSubActiveZone(this),this.tuiActiveZoneParent=e}addSubActiveZone(e){this.subActiveZones=[...this.subActiveZones,e]}removeSubActiveZone(e){this.subActiveZones=m(this.subActiveZones,this.subActiveZones.indexOf(e))}static{this.ɵfac=t.ɵɵngDeclareFactory({minVersion:"12.0.0",version:"16.2.12",ngImport:t,type:f,deps:[],target:t.ɵɵFactoryTarget.Directive})}static{this.ɵdir=t.ɵɵngDeclareDirective({minVersion:"14.0.0",version:"16.2.12",type:f,isStandalone:!0,selector:"[tuiActiveZone]:not(ng-container), [tuiActiveZoneChange]:not(ng-container), [tuiActiveZoneParent]:not(ng-container)",inputs:{tuiActiveZoneParentSetter:["tuiActiveZoneParent","tuiActiveZoneParentSetter"]},outputs:{tuiActiveZoneChange:"tuiActiveZoneChange"},host:{listeners:{"document:mousedown.zoneless":"(0)"}},exportAs:["tuiActiveZone"],ngImport:t})}}e([h],f.prototype,"setZone",null),t.ɵɵngDeclareClassMetadata({minVersion:"12.0.0",version:"16.2.12",ngImport:t,type:f,decorators:[{type:o,args:[{standalone:!0,selector:"[tuiActiveZone]:not(ng-container), [tuiActiveZoneChange]:not(ng-container), [tuiActiveZoneParent]:not(ng-container)",exportAs:"tuiActiveZone",host:{"(document:mousedown.zoneless)":"(0)"}}]}],ctorParameters:function(){return[]},propDecorators:{tuiActiveZoneChange:[{type:s}],tuiActiveZoneParentSetter:[{type:r,args:["tuiActiveZoneParent"]}],setZone:[]}});export{f as TuiActiveZone};export default null;
